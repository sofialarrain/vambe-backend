// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Main Client model
model Client {
  id                String   @id @default(uuid())
  name              String
  email             String   @unique
  phone             String
  assignedSeller    String
  meetingDate       DateTime
  closed            Boolean  @default(false)
  transcription     String   @db.Text
  
  // LLM-extracted categorization fields
  industry          String?
  operationSize     String?  // small, medium, large
  interactionVolume Int?
  discoverySource   String?
  mainMotivation    String?
  urgencyLevel      String?  // immediate, planned, exploratory
  painPoints        String[] @default([])
  technicalRequirements String[] @default([])
  sentiment         String?  // positive, neutral, skeptical
  
  // Processing metadata
  processed         Boolean  @default(false)
  processedAt       DateTime?
  
  // Timestamps
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@index([assignedSeller])
  @@index([industry])
  @@index([closed])
  @@index([meetingDate])
  @@map("clients")
}

// Model for batch processing tracking
model ProcessingBatch {
  id            String   @id @default(uuid())
  fileName      String
  totalClients  Int
  processedClients Int   @default(0)
  status        String   // pending, processing, completed, failed
  errorMessage  String?  @db.Text
  startedAt     DateTime @default(now())
  completedAt   DateTime?
  
  @@map("processing_batches")
}

// Model for analysis logs
model AnalysisLog {
  id          String   @id @default(uuid())
  clientId    String
  action      String   // categorization, prediction, comparison
  result      Json
  executedAt  DateTime @default(now())
  
  @@index([clientId])
  @@map("analysis_logs")
}
